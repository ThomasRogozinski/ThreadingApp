@{
    ViewBag.Title = "Thread Pool";
}
<div style="width: 50%; margin: 0 auto;">
    <p style="margin-top: 40px;">
        This example shows how to use a thread pool. It first creates a ManualResetEvent object,
        which enables the program to know when the thread pool has finished running all of the work items.
        The thread pool puts work items into available threads.
        The WaitOne method on ManualResetEvent is called, which causes the rest of the program to wait until the event is triggered by the last executed work item.
    </p>
    <ul id="messages"></ul>
</div>

@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.2.0.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>

        $(function () {
            // initialize progress bar
            $("#progressbar").progressbar({ value: 0 });

            // initialize the connection to the server
            var threads = $.connection.threadsHub;

            // client-side sendMessage function that will be called from the server-side
            threads.client.showMessage = function (thread, message) {
                // Add the message to the page.
                $('#messages').append('<li><strong>' + thread + '</strong>: ' + message + '</li>');
            };

            threads.client.showProgress = function (value) {
                $("#heading").html(value + "%");
                $("#progressbar").progressbar("value", value);
            };

            // establish the connection to the server and start server-side operation
            $.connection.hub.start().done(function () {
                // call the method CallLongOperation defined in the Hub
                threads.server.runThreadPoolSample();
            });
        });

    </script>
}